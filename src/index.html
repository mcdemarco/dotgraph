<!DOCTYPE html>
<html>
<head>
<title>
<%= name %> (DotGraph)
</title>
<meta charset="utf-8">
<style>
 body {margin:3%;}
 tw-storydata {display:none;}
 #stats {font-style:italic;text-align:center;}
 input#omitTags, input#clusterTags {width:30%;}
 label {white-space:nowrap;}
 div#notes {font-size:smaller;width:40%;padding-top:10px;float:right;}
 h2 {float:left;padding-right:3em;}
 section {clear:both;}
 textarea {min-height:15em;}
 #graphSection {text-align:center;}
 #saveSvgButton {float:left;}
 #scaleUpButton, #scaleDownButton {font-weight:bold;}
</style>
<%= vizScript %>
</head>
<body>
	<h1>DotGraph Proof of <%= name %></h1>

	<div id="stats" title="Twine">
		<span id="nodeCount">0</span>&nbsp;nodes<span id="omitCount"></span>,
		<span id="leafCount">0</span>&nbsp;leaves<span id="looseCount"></span>,
		<span id="linkCount">0</span>&nbsp;links, and
		<span id="average">0</span>&nbsp;links&nbsp;per&nbsp;node.
	</div>

	<h2 id="settingsHeader" style="text-decoration:underline;">Settings</h2>
	<section id="settingsSection">
		<div id="notes">
						<p><b>Notes:</b> The start node is double-circled, as are any unreachable nodes.  When color by length is on, all real nodes are colored in shades of red (shorter than average) to blue (longer than average) based on the relative length of their contents.</p>
						<p>Stray or misplaced nodes can result from the omit tags setting, from duplicate passage names, scripted passage transitions, or other linking issues.</p>
						<p>The layout engine options change the graph style; some options are slower than the default ("dot").  The image format is SVG.  For more information, see <a href="http://mcdemarco.net/tools/scree/dotgraph/">the website</a> or <a href="https://bitbucket.org/mcdemarco/dotgraph/src/default/README.md">the README</a>.</p>
		</div>
	<div>
		<form id="settingsForm">
		</form>
	</div>
	</section>

	<h2 id="graphHeader">Graph</h2>
	<section id="graphSection">
		<button type="button" id="saveSvgButton">Save Image</button>
		<input type="checkbox" id="scaleCheckbox" />&nbsp;<label for="scaleCheckbox">Scale to fit page</label>
		<button type="button" id="scaleDownButton">&ndash;</button>
		<button type="button" id="scaleUpButton">+</button>
		<div id="graph"></div>
		<hr style="clear:both;"/>
	</section>

	<h2 id="dotHeader" style="text-decoration:underline;">Dot Source</h2>
	<section id="dotSection">

		<p>
			If rendering of the graph fails (i.e., you only see the dot source file) or you need the output in a different format, the dot source can also be rendered using the free desktop program <a href="http://www.graphviz.org/">Graphviz</a>, or rendered online at <a href="http://stamm-wilbrandt.de/GraphvizFiddle/">GraphvizFiddle</a>, <a href="http://www.webgraphviz.com">WebGraphviz</a>, or <a href="http://viz-js.com">Viz.js</a>.
		</p>

		<button type="button" id="editButton">Redraw with edits</button>
		<button type="button" id="saveDotButton">Save Source</button><br/>
	
		<textarea id="dotfile" style="width:100%;"></textarea>
	</section>

<%= passages %>

<%= script %>
</body>
</html>
